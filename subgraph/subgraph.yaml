specVersion: 0.0.5
schema:
  file: ./schema.graphql
dataSources:
  # ---------------------------------------------------------------------------
  # CollateralVault
  # ---------------------------------------------------------------------------
  - kind: ethereum
    name: CollateralVault
    network: base-sepolia  # Change to 'base' for mainnet
    source:
      address: "0x0000000000000000000000000000000000000000"  # TODO: Update after deployment
      abi: CollateralVault
      startBlock: 0  # TODO: Update to deployment block
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Agent
        - Deposit
        - Withdrawal
        - ProtocolStats
      abis:
        - name: CollateralVault
          file: ../contracts/out/CollateralVault.sol/CollateralVault.json
      eventHandlers:
        - event: Deposited(indexed uint256,indexed address,uint256)
          handler: handleDeposited
        - event: WithdrawalInitiated(indexed uint256,uint256,uint256)
          handler: handleWithdrawalInitiated
        - event: WithdrawalCancelled(indexed uint256)
          handler: handleWithdrawalCancelled
        - event: WithdrawalExecuted(indexed uint256,indexed address,uint256)
          handler: handleWithdrawalExecuted
        - event: CollateralLocked(indexed uint256,uint256,uint256)
          handler: handleCollateralLocked
        - event: CollateralUnlocked(indexed uint256,uint256,uint256)
          handler: handleCollateralUnlocked
        - event: CollateralSlashed(indexed uint256,uint256,indexed address,uint256)
          handler: handleCollateralSlashed
      file: ./src/mappings/collateral-vault.ts

  # ---------------------------------------------------------------------------
  # TermsRegistry
  # ---------------------------------------------------------------------------
  - kind: ethereum
    name: TermsRegistry
    network: base-sepolia
    source:
      address: "0x0000000000000000000000000000000000000000"  # TODO: Update
      abi: TermsRegistry
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Agent
        - TermsVersion
      abis:
        - name: TermsRegistry
          file: ../contracts/out/TermsRegistry.sol/TermsRegistry.json
      eventHandlers:
        - event: TermsRegistered(indexed uint256,indexed uint256,bytes32,string,uint256,bytes32)
          handler: handleTermsRegistered
        - event: TermsActivated(indexed uint256,indexed uint256)
          handler: handleTermsActivated
        - event: TermsDeactivated(indexed uint256,indexed uint256)
          handler: handleTermsDeactivated
      file: ./src/mappings/terms-registry.ts

  # ---------------------------------------------------------------------------
  # TrustfulValidator
  # ---------------------------------------------------------------------------
  - kind: ethereum
    name: TrustfulValidator
    network: base-sepolia
    source:
      address: "0x0000000000000000000000000000000000000000"  # TODO: Update
      abi: TrustfulValidator
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Agent
        - ValidationEvent
        - ProtocolStats
      abis:
        - name: TrustfulValidator
          file: ../contracts/out/TrustfulValidator.sol/TrustfulValidator.json
      eventHandlers:
        - event: ValidationIssued(indexed uint256,indexed bytes32,uint256,string)
          handler: handleValidationIssued
        - event: ValidationRevoked(indexed uint256,indexed bytes32,uint8)
          handler: handleValidationRevoked
      file: ./src/mappings/trustful-validator.ts

  # ---------------------------------------------------------------------------
  # CouncilRegistry
  # ---------------------------------------------------------------------------
  - kind: ethereum
    name: CouncilRegistry
    network: base-sepolia
    source:
      address: "0x0000000000000000000000000000000000000000"  # TODO: Update
      abi: CouncilRegistry
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Council
        - CouncilMember
        - ProtocolStats
      abis:
        - name: CouncilRegistry
          file: ../contracts/out/CouncilRegistry.sol/CouncilRegistry.json
      eventHandlers:
        - event: CouncilCreated(indexed bytes32,string,string,uint256,uint256)
          handler: handleCouncilCreated
        - event: CouncilUpdated(indexed bytes32)
          handler: handleCouncilUpdated
        - event: CouncilDeactivated(indexed bytes32)
          handler: handleCouncilDeactivated
        - event: CouncilActivated(indexed bytes32)
          handler: handleCouncilActivated
        - event: MemberAdded(indexed bytes32,indexed address)
          handler: handleMemberAdded
        - event: MemberRemoved(indexed bytes32,indexed address)
          handler: handleMemberRemoved
      file: ./src/mappings/council-registry.ts

  # ---------------------------------------------------------------------------
  # ClaimsManager
  # ---------------------------------------------------------------------------
  - kind: ethereum
    name: ClaimsManager
    network: base-sepolia
    source:
      address: "0x0000000000000000000000000000000000000000"  # TODO: Update
      abi: ClaimsManager
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Agent
        - Claim
        - Evidence
        - Vote
        - Council
        - CouncilMember
        - ProtocolStats
      abis:
        - name: ClaimsManager
          file: ../contracts/out/ClaimsManager.sol/ClaimsManager.json
      eventHandlers:
        - event: ClaimFiled(indexed uint256,indexed uint256,indexed address,uint256,uint256,bytes32)
          handler: handleClaimFiled
        - event: EvidenceSubmitted(indexed uint256,bytes32,string,bool)
          handler: handleEvidenceSubmitted
        - event: VoteCast(indexed uint256,indexed address,uint8,uint256)
          handler: handleVoteCast
        - event: ClaimApproved(indexed uint256,uint256)
          handler: handleClaimApproved
        - event: ClaimRejected(indexed uint256)
          handler: handleClaimRejected
        - event: ClaimCancelled(indexed uint256,uint256)
          handler: handleClaimCancelled
        - event: ClaimExecuted(indexed uint256,uint256)
          handler: handleClaimExecuted
      file: ./src/mappings/claims-manager.ts

  # ---------------------------------------------------------------------------
  # RulingExecutor
  # ---------------------------------------------------------------------------
  - kind: ethereum
    name: RulingExecutor
    network: base-sepolia
    source:
      address: "0x0000000000000000000000000000000000000000"  # TODO: Update
      abi: RulingExecutor
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Claim
        - Agent
        - Council
        - ProtocolStats
      abis:
        - name: RulingExecutor
          file: ../contracts/out/RulingExecutor.sol/RulingExecutor.json
      eventHandlers:
        - event: RulingExecuted(indexed uint256,indexed uint256,indexed address,uint256,uint256)
          handler: handleRulingExecuted
        - event: RejectionExecuted(indexed uint256,uint256,bytes32)
          handler: handleRejectionExecuted
      file: ./src/mappings/ruling-executor.ts
